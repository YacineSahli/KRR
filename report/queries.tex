

\section{Fourth query}

Generate-and-test method

\lstset{breaklines=true}
\begin{lstlisting}
1 {rr1(X,Y,Z) : r1(X,Y,Z)} 1 :- r1(X,_,_).

1 {rr2(X,Y,Z) : r2(X,Y,Z)} 1 :- r2(X,_,_).

1 {rr3(X,Y) : r3(X,Y)} 1 :- r3(X,_).

:- rr1(X,Y,Z), rr2(V,U,D), rr3(Y,V). 
\end{lstlisting}

FO rewriting

\begin{lstlisting}
certainty(Z,D) :- r1(X,Y,Z), not r_1(Z,D,X), r2(F_0, F_1, D).
r_1(Z,D,X) :- r1(X,Z_0_0,Z_0_1), not r_2(Z,D,X,Z_0_0,Z_0_1), r1(F_0, F_1, Z), r2(F_2, F_3, D).
r_2(Z,D,X,Y,Z_0_1) :- r1(X,Y,Z_0_1), Z_0_1=Z, r_3(Z,D,X,Y).
r_3(Z,D,X,Y) :- r1(X,Y,Z), r3(Y,V), not r_4(Z,D,X,Y), r2(F_0, F_1, D).
r_4(Z,D,X,Y) :- r1(X,Y,Z), r3(Y,Z_1_0), not r_5(Z,D,X,Y,Z_1_0), r2(F_0, F_1, D).
r_5(Z,D,X,Y,V) :- r1(X,Y,Z), r3(Y,V), r2(V,U,D), not r_6(Z,D,X,Y,V).
r_6(Z,D,X,Y,V) :- r1(X,Y,Z), r3(Y,V), r2(V,Z_2_0,Z_2_1), not r_7(Z,D,X,Y,V,Z_2_0,Z_2_1), r3(F_0, D).
r_7(Z,D,X,Y,V,U,Z_2_1) :- r1(X,Y,Z), r3(Y,V), r2(V,U,Z_2_1), Z_2_1=D, r2(F_2, F_3, D).
\end{lstlisting}

\section{Fifth query}

Generate-and-test method


\begin{lstlisting}
1 {rr1(X,Y,Z) : r1(X,Y,Z)} 1 :- r1(X,_,_).

1 {rr4(X,Y,Z) : r4(X,Y,Z)} 1 :- r4(X,Y,_).

:- rr1(X,Y,Z), rr4(Y,V,W). 
\end{lstlisting}

FO rewriting


\begin{lstlisting}
%q5(z) := ∃x, y, v, w (R 1 (x, y, z) ∧ R 4 (y, v, w))

p0(Z):-r1(X,Y,Z),not p1(Z,X).
p1(Z,X):-r1(X,Y,Z),r1(X,V1,V2),not p2(Z,X,V1,V2).
p2(Z,X,V1,V2):-r1(X,Y,Z),r1(X,V1,V2),d0(Z,Y),V1=Y,V2=Z.

d0(Z,Y):-r4(Y,V,W),not d1(Z,Y,V).
d1(Z,Y,V):-r4(Y,V,W),r4(Y,V,V1),not d2(Z,Y,V,W,V1).
d2(Z,Y,V,W,V1):-r4(Y,V,W),r4(Y,V,V1),V1=W.
\end{lstlisting}

